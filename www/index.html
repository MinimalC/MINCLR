<!DOCTYPE html>
<html><head>
<title>Hello World</title>
</head><body>
    This is the Hello World example.<br />
<%
    String8 now_string = DateTime_now_toString();
    MemoryStream_writeLine(&response->stream, "Heute ist der {0:string}.", 1, now_string);
    Memory_free(now_string);
%><br />

<form  method="post" enctype="multipart/form-data">

    <div>Name: <input type="text" name="Name"></div>

    <div>File: <input type="file" name="File"></div>
    <div>File1: <input type="file" name="File1"></div>

    <textarea name="text" rows=10></textarea>

    <input type="submit" value="Send" />

</form>

<div><%
    if (request->query.length) {
        MemoryStream_write__string(&response->stream, "Query ");
        for (Size m = 0 ; m < request->query.length; ++m) {
            MemoryStream_write(&response->stream, "{0:string}{1:string}={2:string} ", 3, !m ? "?" : "&",
                array_item(request->query.key, m), array_item(request->query.value, m));
        }
    }
%></div>
<div><%
    if (request->form.length) {
        MemoryStream_write__string(&response->stream, "Form ");
        for (Size m = 0 ; m < request->form.length; ++m) {
            MemoryStream_write(&response->stream, "{0:string}{1:string}={2:string} ", 3, !m ? "?" : "&",
                array_item(request->form.key, m), array_item(request->form.value, m));
        }
    }
%></div>
<div><%
    if (request->files.length) {
        MemoryStream_write__string(&response->stream, "Files ");
        for (Size m = 0 ; m < request->files.length; ++m) {
            MemoryStream_write(&response->stream, "{0:string}{1:string} ", 2, array_item(request->files.key, m),
                m == request->files.length - 1 ? " " : ",");

            String data = array_item(request->files.value, m);
            if (data->length) {
                MemoryStream_write(&response->stream, "size {0:uint}{1:string} ", 2, data->length,
                    m == request->files.length - 1 ? " " : ",");
            }
        }
    }
%></div>
<div id="target0"></div>
<div id="target1"></div>
<div id="target2"></div>
<div id="target3"></div>
<div id="target4"></div>
<script type="text/javascript">
/*

function websocket_open(event) {
    this.send(null);
}
function websocket_message(event) {
  document.getElementById("target").innerText = event.data;
}

var req = new WebSocket("http://" + location.host + "/websocket.html");
req.binaryType = "text";
req.addEventListener("open", websocket_open);
req.addEventListener("message", websocket_message);
*/

var xhttp0 = new XMLHttpRequest();
xhttp0.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200)
       document.getElementById("target0").innerHTML = xhttp0.responseText;
};
xhttp0.open("GET", "websocket.html", true);
xhttp0.send();

var xhttp1 = new XMLHttpRequest();
xhttp1.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200)
       document.getElementById("target1").innerHTML = xhttp1.responseText;
};
xhttp1.open("GET", "websocket.html", true);
xhttp1.send();

var xhttp2 = new XMLHttpRequest();
xhttp2.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200)
       document.getElementById("target2").innerHTML = xhttp2.responseText;
};
xhttp2.open("GET", "websocket.html", true);
xhttp2.send();

var xhttp3 = new XMLHttpRequest();
xhttp3.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200)
       document.getElementById("target3").innerHTML = xhttp3.responseText;
};
xhttp3.open("GET", "websocket.html", true);
xhttp3.send();

var xhttp4 = new XMLHttpRequest();
xhttp4.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200)
       document.getElementById("target4").innerHTML = xhttp4.responseText;
};
xhttp4.open("GET", "websocket.html", true);
xhttp4.send();

</script>
</body></html>
